Let's modify our app to calculate and display the 12% VAT (Value Added Tax).
The changes will be focused in two main places:
1.	lib/providers/cart_provider.dart (The "Brain"): We'll update this to calculate Subtotal, VAT, and a new Total Price. We'll also update placeOrder to save this breakdown.
2.	lib/screens/cart_screen.dart (The "UI"): We'll update the "Total" card to display this new three-line breakdown (Subtotal, VAT, Total).
Because of our good architecture, our OrderCard (from Module 11) will automatically be correct, as it just reads the final totalPrice that we will save.

Part A: Update cart_provider.dart (The "Brain")
Let's teach our cart how to calculate VAT.
lib/providers/cart_provider.dart - Part 1: Update Getters
Find your "getters" section. We are going to rename totalPrice to subtotal and add two new getters.

 // ... (inside CartProvider class)
  
  // --- THIS IS THE GETTERS SECTION ---
  
  // 1. RENAME 'totalPrice' to 'subtotal'
  //    This is the total price *before* tax.
  double get subtotal {
    double total = 0.0;
    for (var item in _items) {
      total += (item.price * item.quantity);
    }
    return total;
  }

  // 2. ADD this new getter for VAT (12%)
  double get vat {
    return subtotal * 0.12; // 12% of the subtotal
  }
  
  // 3. ADD this new getter for the FINAL total
  double get totalPriceWithVat {
    return subtotal + vat;
  }
  
  // 4. We can leave the old 'totalPrice' getter for now,
  //    or delete it. Let's update 'itemCount' to be cleaner:
  int get itemCount {
    // This 'fold' is a cleaner way to sum a list.
    return _items.fold(0, (total, item) => total + item.quantity);
  }

(Part A):
●	get subtotal: This is your old totalPrice logic. It's the sum of all item prices * their quantities.
●	get vat: This is a new computed property. It simply takes the subtotal and multiplies it by 0.12 (which is 12%).
●	get totalPriceWithVat: This is the new final price: subtotal + vat.
lib/providers/cart_provider.dart - Part 2: Update the placeOrder Function
Now, when we save an order to Firestore, we need to save this new price breakdown.
Find your placeOrder function and modify the object we send to Firestore.

 // ... (inside CartProvider class)

  Future<void> placeOrder() async {
    if (_userId == null || _items.isEmpty) {
      throw Exception('Cart is empty or user is not logged in.');
    }

    try {
      final List<Map<String, dynamic>> cartData = 
          _items.map((item) => item.toJson()).toList();
      
      // 1. --- THIS IS THE CHANGE ---
      //    Get all our new calculated values
      final double sub = subtotal;
      final double v = vat;
      final double total = totalPriceWithVat;
      final int count = itemCount;

      // 2. Update the data we save to Firestore
      await _firestore.collection('orders').add({
        'userId': _userId,
        'items': cartData,
        'subtotal': sub,       // 3. ADD THIS
        'vat': v,            // 4. ADD THIS
        'totalPrice': total,   // 5. This is now the VAT-inclusive price
        'itemCount': count,
        'status': 'Pending',
        'createdAt': FieldValue.serverTimestamp(),
      });
      // --- END OF CHANGE ---

    } catch (e) {
      print('Error placing order: $e');
      throw e; 
    }
  }

(Part B):
●	We are now saving subtotal, vat, and totalPrice (which is the final price) to our orders document. This is great for receipts and for the admin panel.

Part B: Update cart_screen.dart (The "UI")
Now, let's display this new price breakdown to the user in their cart.
lib/screens/cart_screen.dart - Part 1: The build Method
Find the build method. We are going to find the "Total" Card at the bottom and replace it.
Find and DELETE this old Card:

         // 3. The "Total" Card is the same
          /* DELETE THIS
          Card(
            margin: const EdgeInsets.all(16),
            child: Padding(
              padding: const EdgeInsets.all(16),
              child: Row(
                mainAxisAlignment: MainAxisAlignment.spaceBetween,
                children: [
                  const Text(
                    'Total:',
                    style: TextStyle(fontSize: 20, fontWeight: FontWeight.bold),
                  ),
                  Text(
                    '₱${cart.totalPrice.toStringAsFixed(2)}', // This getter doesn't exist anymore!
                    style: const TextStyle(fontSize: 20, fontWeight: FontWeight.bold),
                  ),
                ],
              ),
            ),
          ),
          */

ADD this new Card in its place:

         // ... (after the Expanded(child: ListView.builder(...))

          // 3. --- THIS IS THE NEW PRICE BREAKDOWN CARD ---
          Card(
            margin: const EdgeInsets.all(16),
            child: Padding(
              padding: const EdgeInsets.all(16),
              child: Column( // 4. Use a Column for multiple rows
                children: [
                  
                  // 5. ROW 1: Subtotal
                  Row(
                    mainAxisAlignment: MainAxisAlignment.spaceBetween,
                    children: [
                      const Text(
                        'Subtotal:',
                        style: TextStyle(fontSize: 16),
                      ),
                      Text(
                        '₱${cart.subtotal.toStringAsFixed(2)}',
                        style: const TextStyle(fontSize: 16),
                      ),
                    ],
                  ),
                  
                  const SizedBox(height: 8),

                  // 6. ROW 2: VAT
                  Row(
                    mainAxisAlignment: MainAxisAlignment.spaceBetween,
                    children: [
                      const Text(
                        'VAT (12%):',
                        style: TextStyle(fontSize: 16),
                      ),
                      Text(
                        '₱${cart.vat.toStringAsFixed(2)}',
                        style: const TextStyle(fontSize: 16),
                      ),
                    ],
                  ),
                  
                  const Divider(height: 20, thickness: 1),

                  // 7. ROW 3: Total
                  Row(
                    mainAxisAlignment: MainAxisAlignment.spaceBetween,
                    children: [
                      const Text(
                        'Total:',
                        style: TextStyle(fontSize: 20, fontWeight: FontWeight.bold),
                      ),
                      Text(
                        '₱${cart.totalPriceWithVat.toStringAsFixed(2)}',
                        style: const TextStyle(fontSize: 20, fontWeight: FontWeight.bold, color: Colors.deepPurple),
                      ),
                    ],
                  ),
                ],
              ),
            ),
          ),
          // --- END OF NEW CARD ---
          
          // ... (The "Place Order" button is unchanged)

(Part C):
●	We've replaced the simple, one-line "Total" Card with a new one.
●	The new Card has a Column that holds three separate Rows.
●	Each Row shows a label (like "Subtotal:") and its corresponding value, which we get from our newly created provider getters: cart.subtotal, cart.vat, and cart.totalPriceWithVat.
●	We add a Divider to make it look like a real receipt.

Expected Output
1.	Full Restart your app.
2.	Add a product to your cart (e.g., a ₱100.00 item).
3.	Go to the Cart Screen.
4.	At the bottom, you will now see a full price breakdown:
○	Subtotal: ₱100.00
○	VAT (12%): ₱12.00
○	(divider)
○	Total: ₱112.00

5.	Add another ₱100.00 item. The totals will update:
○	Subtotal: ₱200.00
○	VAT (12%): ₱24.00
○	Total: ₱224.00

6.	Tap "Place Order".
7.	Check your Firebase Console -> orders collection. Open the new order document.
8.	You will now see the new fields saved: subtotal: 200, vat: 24, and totalPrice: 224.
9.	Go to your "My Orders" screen in the app. The OrderCard will correctly show the total as "Total: ₱224.00" (because it was already reading the totalPrice field, which we now update with the final VAT-inclusive price).

